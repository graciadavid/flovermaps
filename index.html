<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Flovermaps</title>

<!-- Favicon y meta -->
<link rel="icon" href="https://drive.google.com/uc?export=view&id=1M6rOGfSV-YotIBXnYT_KCiXKSLmL5SzW" type="image/png">
<meta name="theme-color" content="#ffffff" />
<meta name="description" content="Planta flores en el mapa y dedica mensajes bonitos." />

<!-- Tipograf√≠a y Leaflet CSS -->
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />

<!-- Leaflet JS primario + fallback autom√°tico -->
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" id="leaflet-cdn"></script>
<script>
  (function ensureLeaflet(){
    if(window.L) return;
    var s=document.createElement('script');
    s.src='https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.js';
    s.onload=function(){ console.log('Leaflet cargado desde cdnjs'); };
    s.onerror=function(){
      var s2=document.createElement('script');
      s2.src='https://cdn.jsdelivr.net/npm/leaflet@1.9.4/dist/leaflet.js';
      s2.onload=function(){ console.log('Leaflet cargado desde jsDelivr'); };
      s2.onerror=function(){ console.error('No se pudo cargar Leaflet'); };
      document.head.appendChild(s2);
    };
    document.head.appendChild(s);
  })();
</script>

<style>
  :root{--ink:#111;--muted:#666; --pink:#ffe6f0}
  body{margin:0;font-family:'Poppins',sans-serif;background:var(--pink);color:var(--ink)}

  .site-header{position:sticky; top:0; z-index:10000; display:flex; justify-content:center; align-items:center; padding:16px; background:#fff; border-bottom:1px solid #eee; min-height:88px}
  .logo-img{height:64px; width:auto; object-fit:contain}

  .counter{margin:8px 12px 0; padding:8px 12px; border-radius:12px; background:#fff}
  .counter .top{font-weight:800}

  .wrap{display:flex; min-height:calc(100vh - 140px)}
  .panel{width:420px; max-width:100%; padding:12px; border-right:1px solid #eee; overflow:auto; background:var(--pink)}
  .card{border:1px solid #e8e8e8; border-radius:12px; padding:12px; background:#fff}
  label{display:block; margin:6px 0 4px; font-size:.92rem}
  input,textarea,button{width:100%; padding:10px; border:1px solid #ddd; border-radius:10px; font-size:.95rem}
  textarea{min-height:56px; resize:vertical}
  .row2{display:grid; grid-template-columns:1fr 1fr; gap:8px}
  .actions{display:flex; flex-direction:column; gap:8px; margin-top:8px}

  #plantBtn{background:#28a745; color:#fff; border:0; border-radius:10px; display:none}
  #shareBtn{background:#0066cc; color:#fff; border:0; border-radius:10px; max-width:320px; display:none}

  .mapArea{flex:1; padding:10px; background:var(--pink)}
  .frame{border:1px solid #e8e8e8; border-radius:12px; overflow:hidden; background:#fff}
  #map{width:100%; height:520px}
  @media(max-width:1024px){ .wrap{flex-direction:column;} .panel{width:100%; border-right:0;} #map{height:50vh} }

  .leaflet-marker-icon[src*="marker-icon"], .leaflet-marker-shadow{display:none!important}
  .emoji-marker{background:transparent; border:none; font-size:28px; line-height:28px; transform:translate(-14px,-28px); pointer-events:none}
</style>
</head>
<body>
<header class="site-header">
  <img id="logoImg" class="logo-img" alt="FLOVERMAPS" />
  <span id="logoFallback" style="display:none;font-weight:800;">FLOVERMAPS</span>
</header>
<div class="counter"><div class="top" id="countTop">üå∏ 0 PLANTADAS</div></div>

<div class="wrap">
  <section class="panel">
    <div class="card">
      <h1>Planta una flor</h1>
      <div class="row2">
        <div><label for="fromName">¬øQui√©n la env√≠a?</label><input id="fromName"></div>
        <div><label for="toName">¬øPara qui√©n?</label><input id="toName"></div>
      </div>
      <label for="message">Mensaje <span id="chars" class="muted">(0/90)</span></label>
      <textarea id="message" maxlength="90"></textarea>
      <label for="place">Ubicaci√≥n</label>
      <input id="place" placeholder="Ej. Viladomat 214, Barcelona" />
      <div class="actions">
        <button id="confirmBtn" style="background:#444;color:#fff;">‚úÖ Confirmar direcci√≥n</button>
        <button id="gpsBtn" style="background:#444;color:#fff;display:none">üìç Usar mi ubicaci√≥n</button>
        <button id="plantBtn">üå± Plantar aqu√≠</button>
      </div>
      <input type="hidden" id="lat"><input type="hidden" id="lng">
    </div>
  </section>
  <section class="mapArea">
    <div class="frame"><div id="map"></div></div>
    <div class="below"><button id="shareBtn">üîó Compartir</button></div>
  </section>
</div>

<script>
// solo muestro cambios relevantes
</script>
</body>
</html>
